<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">  
    <title>AnDetector-用户中心</title>
    <meta name="description" content="">
    <meta name="author" content="templatemo">
    {% load static %}
    
    <link rel="stylesheet" href="{%static "fonts/font-awesome/css/font-awesome.css" %}" type="text/css"/>
    <link rel="stylesheet" href="{%static "css/bootstrap.css" %}" type="text/css"/>
    <link href="{%static "css/templatemo-style.css" %}" rel="stylesheet">
    <link rel="shortcut icon" href="{%static "favicon.ico" %}" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>

    <![endif]-->
  <style>
  .templatemo-content-widget svg{
    height: 90px;
  }
  .templatemo-content-widget i{
   font-size: 90px;
  }
      .templatemo-content-widget section{
              font-size: 20px;
    padding-top: 10px;
          color: #665d5d;
      }
      .templatemo-site-header h1{
              padding-left: 30px;
      }
</style>
  </head>
  <body>  
    <!-- Left column -->
    <div class="templatemo-flex-row">
      <div class="templatemo-sidebar">
        <header class="templatemo-site-header">
          <div class="square"></div>
          <h1>用户中心</h1>
        </header>
        <div class="profile-photo-container">
          <!-- <img src="images/profile-photo.jpg" alt="Profile Photo" class="img-responsive">  --> 
          <div class="profile-photo-overlay"></div>
        </div>      
        <!-- Search box -->
        
        <div class="mobile-menu-icon">
            <i class="fa fa-bars"></i>
        </div>
        <nav class="templatemo-left-nav">          
          <ul>
            <li><a href="#" class="active"><i class="fa fa-history" aria-hidden="true"></i>提交历史</a></li>
            <li><a href="../apkupload/"><i class="fa fa-home fa-fw"></i>官网主页</a></li>
            <li><a href="../apkupload/user/login/"><i class="fa fa-eject fa-fw"></i>退出</a></li>
          </ul>  
        </nav>
      </div>
      <!-- Main content --> 
      <div class="templatemo-content col-1 light-gray-bg">
        <div class="templatemo-top-nav-container">
          <div class="row">
            <nav class="templatemo-top-nav col-lg-12 col-md-12">
               
            </nav> 
          </div>
        </div>
        <div class="templatemo-content-container">
          <div class="templatemo-flex-row flex-content-row">
            <div class="templatemo-content-widget white-bg col-1 text-center" style="background-color: #d1f5d3;">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="basic-info"><g fill="#49c361bf" fill-rule="evenodd"><path opacity=".2" d="M6 6H18V18H6z"></path><path transform="rotate(90 13 5.5)" d="M9.5 4.5H16.5V6.5H9.5z"></path><path d="M12 7H19V9H12zM5 7H10V9H5zM5 11H15V13H5z"></path><path d="M3,3 L3,17 L17,17 L17,7.72409987 L13.0632501,3 L3,3 Z M1,1 L14,1 L19,7 L19,19 L1,19 L1,1 Z" fill-rule="nonzero"></path></g></svg>
              <h2 class="text-uppercase">文件数量</h2>
              <section>{{apknum}}</section>
            </div>

            <div class="templatemo-content-widget white-bg col-1 text-center" style="background-color: #eae7d9;">
              <i class="fa fa-calendar" aria-hidden="true" style="color:#d97272;padding-bottom: 5px;"></i>
              <h2 class="text-uppercase">使用次数</h2>
              <section>{{usingtimes}}</section>
            </div>

            <div class="templatemo-content-widget white-bg col-1 text-center"  style="background-color: #ecfbfc;"   >
              <i class="fa fa-sign-in" aria-hidden="true" style="color:#7cd6df"></i>
              <h2 class="text-uppercase">上次登录时间</h2>
               <section>{{logintime}}</section>                       
            </div>
          </div>
          
         
          <div class="templatemo-flex-row flex-content-row templatemo-overflow-hidden" > <!-- overflow hidden for iPad mini landscape view-->
            <div class="col-1 templatemo-overflow-hidden" >
              <div class="templatemo-content-widget white-bg templatemo-overflow-hidden"style="min-height:350px">
                
                <div class="templatemo-flex-row flex-content-row" id="userhistory">
                  <template>
                              <el-table
                                :data="tabledata"
                                stripe
                                border
                                style="width: 100%">
                                <el-table-column
                                  prop="apkname"
                                  label="文件名称" 
                                
                                  >
                                </el-table-column>
                                  <el-table-column
                                  prop="apkscore"
                                  label="检测得分"

                                  >
                                </el-table-column>
                                <el-table-column
                                  prop="apkresult"
                                  label="文件结果"
                                  >
                                </el-table-column>
                                <el-table-column
                              align="center"
                              width="200">
                              <template slot="header" slot-scope="scope">
                                <el-input
                                  v-model="search"
                                  size="mini"
                                  placeholder="输入关键字搜索"/>
                              </template>
                              <template slot-scope="scope">
                                
                                <el-button
                                  size="mini"
                                  type="danger"
                                  @click="review(scope.$index, scope.row)">查看</el-button>
                              </template>
                            </el-table-column>
                              </el-table>
                            </template>
                </div>                
              </div>
            </div>
          </div>
          <footer class="text-right">
            <form>
              {% csrf_token%}
            </form>
            <p>Copyright &copy; 2020 氰化物 </p>
          </footer>         
        </div>
      </div>
    </div>
    
    <!-- JS -->
    <script src="{%static "js/jquery.min.js" %}"></script>      <!-- jQuery -->
    <script src="{%static "js/jquery-migrate-1.2.1.min.js" %}"></script> <!--  jQuery Migrate Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/vue@latest/dist/vue.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/axios@0.18.0/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

    <script type="text/javascript" src="{%static "js/templatemo-script.js" %}"></script>      <!-- Templatemo Script -->
  <script>
    var a_name = {{apkname|safe}};
    var a_score ={{apkscore|safe}};
    var a_result = {{apkresult|safe}};
    var a_path = {{apkpath|safe}};
    var userdata = [];
    for(var i=0;i<a_name.length;i++){
      userdata.push({"apkname":a_name[i],"apkscore":a_score[i],"apkresult":a_result[i]})
    };

  Vue.prototype.$axios=axios
    axios.defaults.headers.post['Content-Type'] = "text/plain";
  
function post(URL, PARAMS)
{
    var temp = document.createElement("form");

    temp.action = URL;
    temp.method = "post";
    temp.style.display = "none";
    for (var x in PARAMS)
    {
        var opt = document.createElement("textarea");
        opt.name = x;
        opt.value = PARAMS[x];
        // alert(opt.name)
        temp.appendChild(opt);
    }
    document.body.appendChild(temp);
    temp.submit();
    return temp;
} 
var CsrfToken = $("[name='csrfmiddlewaretoken']").val();
    new Vue({
      el: "#userhistory",
      data(){
        return {
          tabledata:userdata
        }
      },
      methods:{
        review(index,row){
  post("apkreview",{'csrfmiddlewaretoken':CsrfToken,"path":a_path[index]});
        }
      }
    })
  </script>
  </body>
</html>